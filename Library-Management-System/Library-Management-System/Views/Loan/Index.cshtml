@model List<LoanViewModel>

<h2>Loan</h2>

@{ if (Context.Session.GetString("Admin") == "true") {
    <a href="/loan/Create" class="btn btn-success">Register Loan</a> } }
<br />
<br />
<table class="table table-striped table-responsive">
    <tr>
        @{ 
            if (Context.Session.GetString("Admin") == "true") 
            {
                <th>Actions</th>
                <th>User Name</th>
            }
        }
        
        <th>Book Title</th>
        <th>Loan Date</th>
        <th>Due Date</th>
        <th>Return Date</th>
    </tr>

    @foreach (LoanViewModel loan in Model) 
    {
        <tr>
            @{ if (Context.Session.GetString("Admin") == "true") 
               {
                    <td>
                        <a href="/loan/edit?id=@loan.Id">✏️</a>
                        <a href="javascript:deleteRecord('loan', @loan.Id)">❎</a>
                    </td>
                    <td>@loan.UserName</td>
               }

            }
            <td>@loan.BookTitle</td>
            <td>@loan.LoanDate.ToShortDateString()</td>
            <td>@loan.DueDate.ToShortDateString()</td>
            <td>@(loan.ReturnDate.HasValue ? loan.ReturnDate?.ToShortDateString() : "Not Returned")</td>
        </tr>
    }
</table>